<!doctype html>
<html>
<head>

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
</head>
<body>
<script>
    window.onload = function(){
            var btn = document.getElementById('btn');
            var errorContainer = document.getElementById('errorMsg');

            btn.addEventListener('click', sendData);
            function sendData(e) {
                var xhr = new XMLHttpRequest();
                xhr.open('PUT', '/edit/editItem');
                var inputs = document.getElementsByTagName('input');

                for (var i = 0; i < inputs.length - 1; i++) {
                    if (inputs[i].value == "") {
                        errorContainer.innerHTML = "Error! Empty Field";
                        console.log('Empty Field');
                        e.preventDefault();
                        return;
                    }
                }
                errorContainer.innerHTML = '';
                var item = {
                    id:parseInt( <%= id%>),
                    name: inputs[0].value,
                    description: inputs[1].value,
                    get completed() {
                        return inputs[2].checked ? 1 : 0
                    }
                };

                console.log('Update item by Id');
                var data = JSON.stringify(item);
                //console.log(item);
                //console.log(data);
                xhr.setRequestHeader('Content-Type','application/json');
                xhr.send(data);
            };
        }


</script>
        <div class="panel well">
    <h3>Edit item!</h3>
    <div class="form-group">
        <label>Name:<input type="text" class="form-control" value="<%= name%>" /></label>
    </div>
    <div class="form-group">
        <label>Description:<input type="text" class="form-control" value="<%= description%>" /></label>
    </div>
    <div class="form-group">
        <label>Completed:<input type="checkbox" <%- completed ? 'checked': ''%> /></label>
    </div>

    <div class="form-group">
        <a href="/edit" class="btn btn-lg btn-info" id="btn">Apply</a>
        <h5 style="color:#f00; font-weight: bold" id="errorMsg"></h5>
    </div>
</div>

</body>
</html>

